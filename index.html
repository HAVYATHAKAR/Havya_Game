<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tech Topic Mastery Game</title>
    <style>
        /* ====== BASIC PAGE STYLING ====== */
        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: radial-gradient(circle at top, #1e293b, #020617);
            color: #e5e7eb;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 16px;
        }

        .app {
            width: 100%;
            max-width: 980px;
            background: rgba(15, 23, 42, 0.96);
            border-radius: 12px;
            box-shadow: 0 18px 45px rgba(0, 0, 0, 0.6);
            padding: 18px 18px 14px;
            border: 1px solid rgba(148, 163, 184, 0.25);
        }

        h1, h2, h3 {
            margin: 0;
        }

        .subtitle {
            font-size: 13px;
            color: #9ca3af;
            margin-top: 4px;
        }

        button {
            border: none;
            border-radius: 8px;
            padding: 9px 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
        }

        button.primary {
            background: #22c55e;
            color: #052e16;
        }

        button.primary:hover {
            filter: brightness(1.1);
        }

        button.ghost {
            background: transparent;
            color: #9ca3af;
            border: 1px solid rgba(148, 163, 184, 0.4);
        }

        button.ghost:hover {
            background: rgba(148, 163, 184, 0.06);
        }

        input[type="text"] {
            width: 100%;
            padding: 9px 11px;
            border-radius: 8px;
            border: 1px solid rgba(148, 163, 184, 0.5);
            background: #020617;
            color: #e5e7eb;
        }

        input[type="text"]::placeholder {
            color: #6b7280;
        }

        .row {
            display: flex;
            justify-content: space-between;
            gap: 16px;
            margin-top: 12px;
        }

        .card {
            flex: 1;
            background: rgba(15, 23, 42, 0.9);
            border-radius: 10px;
            padding: 12px 12px;
            border: 1px solid rgba(31, 41, 55, 0.9);
        }

        .card.small {
            max-width: 340px;
        }

        .chip {
            display: inline-flex;
            padding: 5px 9px;
            border-radius: 999px;
            font-size: 12px;
            background: rgba(148, 163, 184, 0.15);
            margin: 4px 4px 0 0;
        }

        .question-title {
            font-weight: 600;
            margin-bottom: 8px;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 8px;
        }

        .option {
            padding: 8px 10px;
            border-radius: 8px;
            background: rgba(15, 23, 42, 0.95);
            border: 1px solid rgba(51, 65, 85, 0.8);
            font-size: 14px;
            cursor: pointer;
        }

        .option:hover {
            background: rgba(34, 197, 94, 0.08);
            border-color: rgba(34, 197, 94, 0.8);
        }

        .status {
            margin-top: 8px;
            font-size: 13px;
            color: #9ca3af;
        }

        .results-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 6px 8px;
            margin-top: 5px;
            border-radius: 8px;
            background: linear-gradient(90deg, rgba(15, 23, 42, 0.9), transparent);
            font-size: 14px;
        }

        .category {
            font-weight: 700;
        }

        footer {
            margin-top: 12px;
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #6b7280;
            align-items: center;
        }

        .score-pill {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 8px;
            border-radius: 999px;
            background: rgba(34, 197, 94, 0.1);
            color: #bbf7d0;
            font-weight: 500;
        }

        /* ====== START SCREEN OVERLAY ====== */
        #startScreen {
            position: fixed;
            inset: 0;
            background: radial-gradient(circle at top, #0f172a, #020617);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 16px;
            z-index: 20;
        }

        #startBox {
            max-width: 520px;
            width: 100%;
            background: #020617;
            border-radius: 16px;
            padding: 18px 18px 16px;
            border: 1px solid rgba(148, 163, 184, 0.35);
            box-shadow: 0 18px 45px rgba(0, 0, 0, 0.8);
        }

        #startBox h1 {
            font-size: 22px;
        }

        #startBox ol {
            margin: 8px 0 0 18px;
            font-size: 13px;
            color: #9ca3af;
        }

        #startBox p {
            font-size: 13px;
            color: #9ca3af;
            margin-top: 6px;
        }

        #startActions {
            margin-top: 12px;
            display: flex;
            justify-content: flex-end;
            gap: 8px;
        }

        @media (max-width: 800px) {
            .row {
                flex-direction: column;
            }
            .card.small {
                max-width: none;
            }
        }
    </style>
</head>
<body>
    <!-- ====== START SCREEN ====== -->
    <div id="startScreen">
        <div id="startBox">
            <h1>Tech Topic Mastery Game</h1>
            <p>A simple adaptive quiz game that checks how strong you are in different <b>technical topics</b>.</p>
            <p><b>How it works:</b></p>
            <ol>
                <li>After this screen, enter the topics you’ve learned (e.g., Python, Data Structures, Networks).</li>
                <li>For each topic, the game asks up to <b>5 questions</b>, from easiest (Level 1) to hardest (Level 5).</li>
                <li>If you get a question wrong, that topic stops immediately.</li>
                <li>Your performance is graded:
                    <br>0 = Just started, 1 = Still learning, 2 = Weak, 3 = Average, 4 = Strong, 5 = Master.
                </li>
            </ol>
            <p>Objective: <b>Master as many topics as you can!</b></p>
            <div id="startActions">
                <button id="startGameBtn" class="primary">Start Game</button>
            </div>
        </div>
    </div>

    <!-- ====== MAIN GAME UI ====== -->
    <div class="app" id="gameContainer" style="display: none;">
        <header>
            <h1>Tech Topic Mastery Game</h1>
            <div class="subtitle">
                Enter technical topics you’ve studied. The game will adapt difficulty using a decision-tree style question flow.
            </div>
        </header>

        <div class="row">
            <!-- LEFT: INTERACTIVE GAME AREA -->
            <div class="card">
                <h3>1. Enter Topics</h3>
                <div class="subtitle">
                    Examples: <i>Python, Data Structures, Algorithms, Networks, Operating Systems, Databases, Machine Learning, Cybersecurity</i>
                </div>
                <input id="topicsInput" type="text" placeholder="Python, Data Structures, Networks">
                <div style="margin-top: 8px; display: flex; gap: 8px; flex-wrap: wrap;">
                    <button id="useSampleBtn" class="ghost">Use Sample Topics</button>
                    <button id="beginQuizBtn" class="primary">Begin Quiz</button>
                    <button id="resetBtn" class="ghost">Restart Game</button>
                </div>
                <div id="topicList" style="margin-top: 6px;"></div>

                <hr style="margin: 10px 0; border-color: rgba(55,65,81,0.7);">

                <h3>2. Question Area</h3>
                <div id="questionArea" style="margin-top: 6px; display: none;">
                    <div class="question-title" id="questionTitle"></div>
                    <div class="options" id="optionsContainer"></div>
                    <div class="status" id="statusText"></div>
                </div>
                <div id="noQuestionText" class="subtitle" style="margin-top: 6px;">
                    Click <b>Begin Quiz</b> to start. The game will automatically move through your topics.
                </div>
            </div>

            <!-- RIGHT: INSTRUCTIONS + RESULTS -->
            <div class="card small">
                <h3>Game Info & Results</h3>
                <div class="subtitle">
                    <b>Legend</b> (per topic):<br>
                    5 = Master • 4 = Strong • 3 = Average • 2 = Weak • 1 = Still learning • 0 = Just started
                </div>

                <div style="margin-top: 10px; font-size: 13px;">
                    <b>Overall Score:</b>
                    <span class="score-pill">
                        <span id="overallScore">0</span>/<span id="overallTotal">0</span> correct
                    </span>
                </div>

                <div id="resultsArea" style="margin-top: 10px; display: none;">
                    <h4 style="margin: 0 0 4px;">Per-topic Results</h4>
                    <div id="resultsList"></div>
                </div>

                <div class="subtitle" style="margin-top: 10px;">
                    Game ends automatically after all topics are evaluated.
                </div>

                <div style="margin-top: 8px; display: flex; gap: 8px; flex-wrap: wrap;">
                    <button id="downloadReportBtn" class="ghost">Download Report</button>
                </div>

                <div style="margin-top: 10px; font-size: 12px; color: #9ca3af;">
                    <b>Tips:</b>
                    <ul style="margin: 4px 0 0 16px; padding: 0;">
                        <li>Pick 3–5 topics for a balanced game.</li>
                        <li>Try to reach <b>Master</b> in at least one topic.</li>
                    </ul>
                </div>
            </div>
        </div>

        <footer>
            <div>Interactive HTML5 Game • Single file (HTML + CSS + JS)</div>
            <div>Game Over = All topics evaluated</div>
        </footer>
    </div>

    <script>
        // ====== QUESTION BANK FOR COMMON TECHNICAL TOPICS ======
        // Each topic has 5 questions (Level 1 = easiest, Level 5 = hardest)
        const QUESTION_BANK = {
            "python": [
                {
                    q: "What does the function print() do in Python?",
                    opts: [
                        "Stores data in a file",
                        "Displays output on the screen",
                        "Stops the program",
                        "Creates a new variable"
                    ],
                    a: 1
                },
                {
                    q: "Which of these is an immutable data type in Python?",
                    opts: ["list", "tuple", "set", "dict"],
                    a: 1
                },
                {
                    q: "What is list comprehension mainly used for?",
                    opts: [
                        "Concise creation of lists",
                        "Declaring classes",
                        "Handling exceptions",
                        "Managing memory"
                    ],
                    a: 0
                },
                {
                    q: "What is the time complexity of accessing an element by index in a Python list?",
                    opts: ["O(1)", "O(n)", "O(log n)", "O(n log n)"],
                    a: 0
                },
                {
                    q: "In CPython, the Global Interpreter Lock (GIL) mainly affects:",
                    opts: [
                        "Disk read/write",
                        "Parallel execution of Python threads",
                        "Network latency",
                        "File formats"
                    ],
                    a: 1
                }
            ],
            "data structures": [
                {
                    q: "Which data structure uses FIFO (First In, First Out)?",
                    opts: ["Stack", "Queue", "Tree", "Graph"],
                    a: 1
                },
                {
                    q: "Which data structure is best for LIFO operations?",
                    opts: ["Queue", "Stack", "Heap", "Array"],
                    a: 1
                },
                {
                    q: "What is the average time complexity of search in a balanced Binary Search Tree?",
                    opts: ["O(1)", "O(log n)", "O(n)", "O(n log n)"],
                    a: 1
                },
                {
                    q: "Which structure is commonly used to implement a priority queue?",
                    opts: ["Array", "Linked List", "Heap", "Hash Table"],
                    a: 2
                },
                {
                    q: "Which representation is most memory-efficient for sparse graphs?",
                    opts: ["Adjacency matrix", "Adjacency list", "Full matrix", "Bitmap"],
                    a: 1
                }
            ],
            "algorithms": [
                {
                    q: "Binary search is an example of which technique?",
                    opts: ["Greedy", "Divide and conquer", "Dynamic programming", "Backtracking"],
                    a: 1
                },
                {
                    q: "Which sorting algorithm has average time complexity O(n log n)?",
                    opts: ["Bubble sort", "Insertion sort", "Merge sort", "Selection sort"],
                    a: 2
                },
                {
                    q: "Which technique uses overlapping subproblems and optimal substructure?",
                    opts: ["Greedy", "Divide and conquer", "Dynamic programming", "Brute force"],
                    a: 2
                },
                {
                    q: "Worst-case time complexity of Quick Sort is:",
                    opts: ["O(n)", "O(n log n)", "O(n^2)", "O(log n)"],
                    a: 2
                },
                {
                    q: "Dijkstra's algorithm is used to:",
                    opts: [
                        "Sort numbers",
                        "Find shortest paths with non-negative edge weights",
                        "Compress files",
                        "Encrypt data"
                    ],
                    a: 1
                }
            ],
            "networks": [
                {
                    q: "Which model has 7 layers including Application and Transport?",
                    opts: ["TCP/IP", "OSI", "HTTP", "Ethernet"],
                    a: 1
                },
                {
                    q: "Which protocol is connectionless?",
                    opts: ["TCP", "UDP", "FTP", "SSH"],
                    a: 1
                },
                {
                    q: "What does IP stand for?",
                    opts: ["Internet Provider", "Internet Protocol", "Internal Process", "Interface Path"],
                    a: 1
                },
                {
                    q: "Which device forwards packets between different networks?",
                    opts: ["Switch", "Router", "Hub", "Repeater"],
                    a: 1
                },
                {
                    q: "Subnetting is mainly used to:",
                    opts: ["Encrypt data", "Divide IP networks", "Boost CPU speed", "Compress images"],
                    a: 1
                }
            ],
            "operating systems": [
                {
                    q: "What is the main role of an operating system?",
                    opts: [
                        "Design web pages",
                        "Manage hardware and resources",
                        "Compile Java code",
                        "Translate languages"
                    ],
                    a: 1
                },
                {
                    q: "Which of these is a CPU scheduling algorithm?",
                    opts: ["Round Robin", "Dijkstra", "DFS", "Bellman-Ford"],
                    a: 0
                },
                {
                    q: "Virtual memory allows the system to:",
                    opts: [
                        "Use disk space as extension of RAM",
                        "Run without RAM",
                        "Access the internet",
                        "Compile programs faster"
                    ],
                    a: 0
                },
                {
                    q: "Which of these is a synchronization primitive?",
                    opts: ["Semaphore", "Pointer", "Struct", "Frame"],
                    a: 0
                },
                {
                    q: "Context switching means:",
                    opts: [
                        "Switching networks",
                        "Switching CPU from one process/thread to another",
                        "Switching monitors",
                        "Switching keyboards"
                    ],
                    a: 1
                }
            ],
            "databases": [
                {
                    q: "SQL stands for:",
                    opts: [
                        "Simple Query List",
                        "Structured Query Language",
                        "Secure Query Language",
                        "Scripted Queue Logic"
                    ],
                    a: 1
                },
                {
                    q: "Which of these is a NoSQL type?",
                    opts: ["Relational", "Document store", "Flat file", "CSV"],
                    a: 1
                },
                {
                    q: "A primary key in a table is:",
                    opts: [
                        "A secret code",
                        "A unique identifier for a row",
                        "A foreign key",
                        "An index on all columns"
                    ],
                    a: 1
                },
                {
                    q: "In ACID, the 'A' stands for:",
                    opts: ["Atomicity", "Availability", "Authentication", "Allocation"],
                    a: 0
                },
                {
                    q: "Which index type is good for range queries?",
                    opts: ["Hash index", "B-tree index", "Bitmap index", "No index"],
                    a: 1
                }
            ],
            "machine learning": [
                {
                    q: "Which of these is a supervised learning algorithm?",
                    opts: ["K-means", "Linear regression", "Apriori", "PCA"],
                    a: 1
                },
                {
                    q: "Overfitting occurs when a model:",
                    opts: [
                        "Performs well on training but poorly on new data",
                        "Performs poorly on both",
                        "Never converges",
                        "Uses too little data"
                    ],
                    a: 0
                },
                {
                    q: "Which metric is commonly used for regression models?",
                    opts: ["Accuracy", "Mean Squared Error", "F1-score", "Recall"],
                    a: 1
                },
                {
                    q: "Gradient descent is used to minimize:",
                    opts: ["Batch size", "Number of features", "Loss function", "Learning rate"],
                    a: 2
                },
                {
                    q: "Which model is well suited for sequential data?",
                    opts: ["CNN", "RNN", "KNN", "Naive Bayes"],
                    a: 1
                }
            ],
            "cybersecurity": [
                {
                    q: "Phishing is:",
                    opts: [
                        "A network protocol",
                        "An attempt to steal information via fake messages",
                        "A hashing algorithm",
                        "A firewall type"
                    ],
                    a: 1
                },
                {
                    q: "SSL/TLS is mainly used to provide:",
                    opts: ["Authentication and encryption", "File compression", "Backup storage", "Virus removal"],
                    a: 0
                },
                {
                    q: "Which is a good password practice?",
                    opts: [
                        "Use the same password everywhere",
                        "Share passwords with friends",
                        "Use long random passwords",
                        "Write passwords on your monitor"
                    ],
                    a: 2
                },
                {
                    q: "2FA stands for:",
                    opts: [
                        "Two-Factor Authentication",
                        "Two File Access",
                        "Transfer File Authorization",
                        "Triple Factor Access"
                    ],
                    a: 0
                },
                {
                    q: "Which of these is a strong modern hashing family?",
                    opts: ["MD5", "SHA-1", "SHA-2 / SHA-3", "Plain text"],
                    a: 2
                }
            ]
        };

        const CATEGORIES = [
            "Just started",     // 0 correct
            "Still learning",   // 1
            "Weak",             // 2
            "Average",          // 3
            "Strong",           // 4
            "Master"            // 5
        ];

        // ====== STATE ======
        let gameState = {
            queue: [],          // topics waiting to be evaluated
            current: null,      // current topic object
            finished: [],       // results per topic
            totalCorrect: 0,    // overall correct
            totalQuestions: 0   // total questions possible (topics * 5)
        };

        // ====== DOM ELEMENTS ======
        const startScreen = document.getElementById("startScreen");
        const startGameBtn = document.getElementById("startGameBtn");
        const gameContainer = document.getElementById("gameContainer");

        const topicsInput = document.getElementById("topicsInput");
        const useSampleBtn = document.getElementById("useSampleBtn");
        const beginQuizBtn = document.getElementById("beginQuizBtn");
        const resetBtn = document.getElementById("resetBtn");

        const topicList = document.getElementById("topicList");

        const questionArea = document.getElementById("questionArea");
        const questionTitle = document.getElementById("questionTitle");
        const optionsContainer = document.getElementById("optionsContainer");
        const statusText = document.getElementById("statusText");
        const noQuestionText = document.getElementById("noQuestionText");

        const resultsArea = document.getElementById("resultsArea");
        const resultsList = document.getElementById("resultsList");
        const overallScoreSpan = document.getElementById("overallScore");
        const overallTotalSpan = document.getElementById("overallTotal");
        const downloadReportBtn = document.getElementById("downloadReportBtn");

        // ====== HELPERS ======
        function normalizeTopic(t) {
            return t.trim().toLowerCase();
        }

        function getTopicsFromInput() {
            const raw = topicsInput.value.trim();
            if (!raw) return [];
            const arr = raw.split(",").map(normalizeTopic).filter(Boolean);
            // remove duplicates
            return [...new Set(arr)];
        }

        function showTopicChips(list) {
            topicList.innerHTML = "";
            list.forEach(t => {
                const chip = document.createElement("span");
                chip.className = "chip";
                chip.textContent = t;
                topicList.appendChild(chip);
            });
        }

        function generateGenericBank(name) {
            const base = name || "this topic";
            return [
                {
                    q: `What is the basic idea of ${base}?`,
                    opts: [
                        "A fundamental definition",
                        "A deployment script",
                        "An unrelated concept",
                        "A backup tool"
                    ],
                    a: 0
                },
                {
                    q: `After learning basics of ${base}, what should you usually focus on?`,
                    opts: [
                        "Core operations and examples",
                        "Skipping practice",
                        "Random unrelated topics",
                        "Only memorizing names"
                    ],
                    a: 0
                },
                {
                    q: `Which activity shows that you are applying ${base}?`,
                    opts: [
                        "Just reading theory",
                        "Doing hands-on problems/projects",
                        "Ignoring it for months",
                        "Closing your IDE"
                    ],
                    a: 1
                },
                {
                    q: `Which approach deepens knowledge in ${base}?`,
                    opts: [
                        "Building small projects",
                        "Avoiding questions",
                        "Relying on guesswork",
                        "Never revising"
                    ],
                    a: 0
                },
                {
                    q: `Which of these looks like an advanced use of ${base}?`,
                    opts: [
                        "Integrating it into larger systems",
                        "Forgetting everything after exam",
                        "Using it only once",
                        "Never trying complex tasks"
                    ],
                    a: 0
                }
            ];
        }

        function prepareQueue(topics) {
            const queue = topics.map(name => {
                const key = normalizeTopic(name);
                const bank = QUESTION_BANK[key] || generateGenericBank(name);
                return {
                    name: name,
                    key,
                    bank,
                    index: 0,
                    correctCount: 0
                };
            });
            return queue;
        }

        function updateOverallScoreDisplay() {
            overallScoreSpan.textContent = gameState.totalCorrect;
            overallTotalSpan.textContent = gameState.totalQuestions;
        }

        // ====== GAME CONTROL FLOW ======
        function startQuiz() {
            const topics = getTopicsFromInput();
            if (topics.length === 0) {
                alert("Please enter at least one topic (comma-separated).");
                return;
            }

            showTopicChips(topics);

            gameState.queue = prepareQueue(topics);
            gameState.finished = [];
            gameState.totalCorrect = 0;
            gameState.totalQuestions = topics.length * 5;
            updateOverallScoreDisplay();

            resultsArea.style.display = "none";
            resultsList.innerHTML = "";
            noQuestionText.style.display = "none";
            questionArea.style.display = "block";

            nextTopic();
        }

        function nextTopic() {
            if (gameState.queue.length === 0) {
                endGame();
                return;
            }
            gameState.current = gameState.queue.shift();
            showCurrentQuestion();
        }

        function showCurrentQuestion() {
            const cur = gameState.current;
            const idx = cur.index;
            const qObj = cur.bank[idx];

            questionTitle.textContent = `${cur.name} — Level ${idx + 1}: ${qObj.q}`;
            optionsContainer.innerHTML = "";

            qObj.opts.forEach((opt, i) => {
                const btn = document.createElement("div");
                btn.className = "option";
                btn.textContent = opt;
                btn.tabIndex = 0;
                btn.onclick = () => handleAnswer(i);
                btn.onkeydown = (e) => {
                    if (e.key === "Enter") handleAnswer(i);
                };
                optionsContainer.appendChild(btn);
            });

            statusText.textContent =
                `Topic: ${cur.name} • Correct so far: ${cur.correctCount}/5`;
        }

        function handleAnswer(selectedIndex) {
            const cur = gameState.current;
            const idx = cur.index;
            const qObj = cur.bank[idx];

            const isCorrect = (selectedIndex === qObj.a);

            if (isCorrect) {
                cur.correctCount += 1;
                gameState.totalCorrect += 1;
                updateOverallScoreDisplay();

                if (cur.index < cur.bank.length - 1) {
                    cur.index += 1;
                    statusText.textContent = "Correct! Moving to the next level...";
                    setTimeout(showCurrentQuestion, 600);
                } else {
                    // all 5 correct
                    finalizeCurrentTopic();
                }
            } else {
                statusText.textContent = "Wrong answer. This topic stops here.";
                setTimeout(finalizeCurrentTopic, 700);
            }
        }

        function finalizeCurrentTopic() {
            const cur = gameState.current;
            const score = cur.correctCount;
            const category = CATEGORIES[score];

            gameState.finished.push({
                name: cur.name,
                score,
                category
            });

            gameState.current = null;
            nextTopic();
        }

        function endGame() {
            questionArea.style.display = "none";
            noQuestionText.style.display = "block";
            noQuestionText.textContent =
                "Game over! All topics evaluated. Scroll to the Results to see your mastery levels.";

            showResults();
        }

        function showResults() {
            resultsArea.style.display = "block";
            resultsList.innerHTML = "";

            gameState.finished.forEach(result => {
                const row = document.createElement("div");
                row.className = "results-row";

                const left = document.createElement("div");
                left.innerHTML =
                    `<div><b>${result.name}</b></div>` +
                    `<div style="font-size: 12px; color: #9ca3af;">Correct: ${result.score}/5</div>`;

                const right = document.createElement("div");
                right.className = "category";
                right.textContent = result.category;

                row.appendChild(left);
                row.appendChild(right);
                resultsList.appendChild(row);
            });
        }

        function resetGame() {
            topicsInput.value = "";
            topicList.innerHTML = "";
            questionArea.style.display = "none";
            noQuestionText.style.display = "block";
            noQuestionText.textContent =
                "Click Begin Quiz to start. The game will automatically move through your topics.";

            resultsArea.style.display = "none";
            resultsList.innerHTML = "";
            gameState = {
                queue: [],
                current: null,
                finished: [],
                totalCorrect: 0,
                totalQuestions: 0
            };
            updateOverallScoreDisplay();
        }

        function downloadReport() {
            if (gameState.finished.length === 0) {
                alert("No results yet. Play the game first!");
                return;
            }

            let text = "Tech Topic Mastery Game — Report\n\n";
            text += `Total correct: ${gameState.totalCorrect}/${gameState.totalQuestions}\n\n`;
            gameState.finished.forEach(r => {
                text += `${r.name}: ${r.score}/5 — ${r.category}\n`;
            });

            const blob = new Blob([text], { type: "text/plain" });
            const url = URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.href = url;
            a.download = "Tech_Topic_Mastery_Report.txt";
            a.click();
            URL.revokeObjectURL(url);
        }

        // ====== EVENT LISTENERS ======
        startGameBtn.addEventListener("click", () => {
            startScreen.style.display = "none";
            gameContainer.style.display = "block";
        });

        useSampleBtn.addEventListener("click", () => {
            topicsInput.value = "Python, Data Structures, Algorithms, Networks, Machine Learning";
            showTopicChips(["python", "data structures", "algorithms", "networks", "machine learning"]);
        });

        beginQuizBtn.addEventListener("click", startQuiz);
        resetBtn.addEventListener("click", resetGame);
        downloadReportBtn.addEventListener("click", downloadReport);

        topicsInput.addEventListener("keydown", (e) => {
            if (e.key === "Enter") {
                startQuiz();
            }
        });
    </script>
</body>
</html>
